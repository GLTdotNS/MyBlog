{"version":3,"file":"PreviewCode.js","names":["PreviewContainer","styled","Box","PreviewInner","PreviewCode","props","aceEditorRef","useRef","useEffect","current","editor","renderer","$cursorLayer","element","style","opacity","textInput","getElement","disabled","handleEditorChange","useCallback","value","type","fixedLanguage","options","language","mode","code","highlightedLines","createHighlightMarkers","undefined","ACE_SET_OPTIONS","ACE_EDITOR_PROPS"],"sources":["../src/PreviewCode.tsx"],"sourcesContent":["import React, {useCallback, useEffect, useRef} from 'react'\nimport AceEditor from 'react-ace'\nimport styled from 'styled-components'\nimport {Box} from '@sanity/ui'\nimport {ACE_EDITOR_PROPS, ACE_SET_OPTIONS} from './config'\nimport createHighlightMarkers from './createHighlightMarkers'\nimport {CodeInputType, CodeInputValue} from './types'\nimport './editorSupport'\n\nconst PreviewContainer = styled(Box)`\n  position: relative;\n`\n\nconst PreviewInner = styled(Box)`\n  background-color: #272822;\n\n  .ace_editor {\n    box-sizing: border-box;\n    cursor: default;\n    pointer-events: none;\n  }\n\n  .ace_content {\n    box-sizing: border-box;\n    overflow: hidden;\n  }\n`\n\nexport interface PreviewCodeProps {\n  type?: CodeInputType\n  value?: CodeInputValue\n}\n\nexport default function PreviewCode(props: PreviewCodeProps) {\n  const aceEditorRef = useRef<any>()\n\n  useEffect(() => {\n    if (!aceEditorRef?.current) return\n\n    const editor = aceEditorRef.current?.editor\n\n    if (editor) {\n      // Avoid cursor and focus tracking by Ace\n      editor.renderer.$cursorLayer.element.style.opacity = 0\n      editor.textInput.getElement().disabled = true\n    }\n  }, [])\n\n  const handleEditorChange = useCallback(() => {\n    // do nothing when the editor changes\n  }, [])\n\n  const {value, type} = props\n  const fixedLanguage = type?.options?.language\n\n  const mode = value?.language || fixedLanguage || 'text'\n\n  return (\n    <PreviewContainer>\n      <PreviewInner padding={4}>\n        <AceEditor\n          ref={aceEditorRef}\n          focus={false}\n          mode={mode}\n          theme=\"monokai\"\n          width=\"100%\"\n          onChange={handleEditorChange}\n          maxLines={200}\n          readOnly\n          wrapEnabled\n          showPrintMargin={false}\n          highlightActiveLine={false}\n          cursorStart={-1}\n          value={(value && value.code) || ''}\n          markers={\n            value && value.highlightedLines\n              ? createHighlightMarkers(value.highlightedLines)\n              : undefined\n          }\n          tabSize={2}\n          showGutter={false}\n          setOptions={ACE_SET_OPTIONS}\n          editorProps={ACE_EDITOR_PROPS}\n        />\n      </PreviewInner>\n    </PreviewContainer>\n  )\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAwB;AAAA;AAAA;AAAA;AAAA;AAExB,IAAMA,gBAAgB,GAAG,IAAAC,yBAAM,EAACC,OAAG,CAAC,8FAEnC;AAED,IAAMC,YAAY,GAAG,IAAAF,yBAAM,EAACC,OAAG,CAAC,0RAa/B;AAOc,SAASE,WAAW,CAACC,KAAuB,EAAE;EAAA;EAC3D,IAAMC,YAAY,GAAG,IAAAC,aAAM,GAAO;EAElC,IAAAC,gBAAS,EAAC,MAAM;IAAA;IACd,IAAI,EAACF,YAAY,aAAZA,YAAY,eAAZA,YAAY,CAAEG,OAAO,GAAE;IAE5B,IAAMC,MAAM,4BAAGJ,YAAY,CAACG,OAAO,0DAApB,sBAAsBC,MAAM;IAE3C,IAAIA,MAAM,EAAE;MACV;MACAA,MAAM,CAACC,QAAQ,CAACC,YAAY,CAACC,OAAO,CAACC,KAAK,CAACC,OAAO,GAAG,CAAC;MACtDL,MAAM,CAACM,SAAS,CAACC,UAAU,EAAE,CAACC,QAAQ,GAAG,IAAI;IAC/C;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMC,kBAAkB,GAAG,IAAAC,kBAAW,EAAC,MAAM;IAC3C;EAAA,CACD,EAAE,EAAE,CAAC;EAEN,IAAOC,KAAK,GAAUhB,KAAK,CAApBgB,KAAK;IAAEC,IAAI,GAAIjB,KAAK,CAAbiB,IAAI;EAClB,IAAMC,aAAa,GAAGD,IAAI,aAAJA,IAAI,wCAAJA,IAAI,CAAEE,OAAO,kDAAb,cAAeC,QAAQ;EAE7C,IAAMC,IAAI,GAAG,CAAAL,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEI,QAAQ,KAAIF,aAAa,IAAI,MAAM;EAEvD,oBACE,6BAAC,gBAAgB,qBACf,6BAAC,YAAY;IAAC,OAAO,EAAE;EAAE,gBACvB,6BAAC,iBAAS;IACR,GAAG,EAAEjB,YAAa;IAClB,KAAK,EAAE,KAAM;IACb,IAAI,EAAEoB,IAAK;IACX,KAAK,EAAC,SAAS;IACf,KAAK,EAAC,MAAM;IACZ,QAAQ,EAAEP,kBAAmB;IAC7B,QAAQ,EAAE,GAAI;IACd,QAAQ;IACR,WAAW;IACX,eAAe,EAAE,KAAM;IACvB,mBAAmB,EAAE,KAAM;IAC3B,WAAW,EAAE,CAAC,CAAE;IAChB,KAAK,EAAGE,KAAK,IAAIA,KAAK,CAACM,IAAI,IAAK,EAAG;IACnC,OAAO,EACLN,KAAK,IAAIA,KAAK,CAACO,gBAAgB,GAC3B,IAAAC,+BAAsB,EAACR,KAAK,CAACO,gBAAgB,CAAC,GAC9CE,SACL;IACD,OAAO,EAAE,CAAE;IACX,UAAU,EAAE,KAAM;IAClB,UAAU,EAAEC,uBAAgB;IAC5B,WAAW,EAAEC;EAAiB,EAC9B,CACW,CACE;AAEvB"}